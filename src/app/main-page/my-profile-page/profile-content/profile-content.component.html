<div *ngIf="this.otherUserId != undefined">
  <button
    class="backwards"
    routerLink="/dashboard/connected-users"
    mat-button
    color="primary"
  >
    <mat-icon>arrow_back </mat-icon>Retour
  </button>
  <h1 class="text-center">
    Profil d'un utilisateur
    <h5>
      <span class="badge bg-dark rounded-pill badge-notification">admin</span>
    </h5>
  </h1>
</div>

<mat-card class="text-wrap">
  <form>
    <div class="container rounded bg-white">
      <div class="row">
        <div class="col-md-3">
          <div
            class="
              d-flex
              flex-column
              align-items-center
              text-center
              pb-3
              pl-3
              pr-3
            "
          >
            <img
              class="rounded-circle mt-2"
              width="150px"
              src="https://ui-avatars.com/api/?name={{ username }}"
            /><span class="font-weight-bold">{{ username }}</span
            ><span class="text-black-50">{{ user_mail }}</span
            ><span
              ><br />
              <div class="text-center">
                <button
                  (click)="showSuccess()"
                  mat-button
                  disabled
                  color="accent"
                  class="border"
                  type="button"
                >
                  Voir les succ√®s üèÜ
                </button>
              </div>
            </span>
            <br />
            <span
              >Rang : <mat-chip>{{ grade }}</mat-chip></span
            >
            <mat-progress-bar
              mode="determinate"
              class="{{ grade }}"
              value="{{ (current_xp * 100) / next_xp }}"
            ></mat-progress-bar
            >{{ current_xp }} / {{ next_xp }}
          </div>
        </div>
        <div class="col-md-5">
          <div class="p-3 py-3">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h4 class="text-right">Profil</h4>
            </div>
            <div class="row mt-2">
              <div class="col-md-6">
                <mat-label class="labels">Nom d'utilisateur</mat-label
                ><input
                  mat-input
                  #new_user_name
                  type="text"
                  class="form-control"
                  placeholder="Nom d'utilisateur"
                  value="{{ username }}"
                />
              </div>
            </div>
            <div class="row mt-3">
              <div class="col-md-12">
                <mat-label class="labels">Email</mat-label
                ><input
                  disabled
                  mat-input
                  type="text"
                  #new_user_mail
                  class="form-control"
                  placeholder="Email"
                  value="{{ user_mail }}"
                />
              </div>
            </div>

            <div class="row mt-3">
              <div class="col-md-12">
                <label class="labels">Derni√®re connexion</label
                ><input
                  type="text"
                  disabled
                  class="form-control"
                  value="{{ last_login }}"
                />
              </div>
            </div>
            <div class="row mt-3">
              <div class="col-md-12">
                <label class="labels">R√¥les</label
                ><mat-chip-list
                  ><mat-chip *ngFor="let role of roles">{{
                    role
                  }}</mat-chip></mat-chip-list
                >
              </div>
            </div>

            <div class="row mt-3">
              <div class="col-md-12">
                <label class="labels"
                  ><span>Sp√©cification des allerg√®nes</span></label
                >
                <mat-form-field class="w-100" appearance="fill">
                  <mat-label>Allergies</mat-label>
                  <mat-chip-list #chipList aria-label="Fruit selection">
                    <mat-chip
                      *ngFor="let fruit of fruits"
                      (removed)="remove(fruit)"
                    >
                      {{ fruit }}
                      <button matChipRemove>
                        <mat-icon>cancel</mat-icon>
                      </button>
                    </mat-chip>
                    <input
                      mat-input
                      placeholder="Allerg√®ne ..."
                      #fruitInput
                      [matAutocomplete]="auto"
                      [matChipInputFor]="chipList"
                      [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                      (matChipInputTokenEnd)="add($event)"
                    />
                  </mat-chip-list>
                  <mat-autocomplete
                    #auto="matAutocomplete"
                    (optionSelected)="selected($event)"
                  >
                    <mat-option
                      *ngFor="let fruit of filteredFruits | async"
                      [value]="fruit"
                    >
                      {{ fruit }}
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>
        <div class="text-center">
          <button
            mat-button
            color="primary"
            (click)="writeUser(new_user_name.value, fruits)"
            class="border"
            type="button"
          >
            Sauvegarder les changements
          </button>
        </div>
      </div>
    </div>
  </form>
</mat-card>
<!-- <ng-template #success>
<router-outlet></router-outlet> </ng-template> -->
